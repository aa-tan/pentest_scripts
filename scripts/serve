#!/bin/bash

# Default Device
DEVICE="tun0"

if [ $# -eq 2 ]; then
    DEVICE=$2
fi

if ip a s $DEVICE &>/dev/null; then
    IP=$(ip a s $DEVICE | sed -n 3p | grep -o -m 1 "[0-9\.]*" | head -1);
else
    echo "Device $DEVICE not found.";
    exit 1;
fi

if ! command -v python &>/dev/null; then
    echo "Python not found."
    exit 1
fi

if [[ $(python --version 2>&1 | cut -c 7-8) -eq 2 ]]; then
    MODULE="SimpleHTTPServer"
else
    MODULE="http.server"
fi


echo -n "curl -O $IP:8000/" | xsel -ib 
echo "String 'curl -O http://$IP:8000/' has been copied to clipboard"
python -m $MODULE
